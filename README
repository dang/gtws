Great Teeming Workspaces

This handles workspaces for multiple versions of multiple projects.  You can
create, update, enter and leave workspaces easily, and each <project, version>
combo has at most one local origin that syncs to and from upstream.  All other
workspaces update from the local origin.

Layout is as follows:

${GTWS_ORIGIN}/<project>/<repo>[/<version>]
${GTWS_BASE_SRCDIR}/<project>/<version>/<workspacename>/{<repo>[,<repo>...]}

Each level in the source tree (plus the homedir for globals) can have a .gtwsrc
file in it that maintains settings and bash code relevant to that level.  Each
more specific level overrides higher levels.

- Setup Overview
	- Checkout gtws
		git clone ssh://git@buildbot.aa.ghs.com/home/git/gtws.git
	- Set up your ${HOME}/.gtwsrc
		- Should include GTWS_ORIGIN, optionally GTWS_SETPROMPT
	- Add the repo directory to your path
		export PATH="${PATH}:/path/to/gtws
	- Profit

- Configuration
	Configuration is via cascading .gtwsrc files.  The real path down from
	the root is walked, and each .gtwsrc file found is sourced in turn.
	More specific files override less specific ones.

	These settings should be in your top level ~/.gtws/.gtwsrc:

	- GTWS_BASE_SRCDIR
		- This is the base of all the projects source trees.  Defaults to $HOME/src
	- GTWS_ORIGIN
		- This sets the location of the origin git trees.  Defaults to $HOME/origin
	- GTWS_SETPROMPT
		- This is optional.  If set, the shell prompt will be changed
		  to have the workspace name in it.
	- GTWS_DEFAULT_PROJECT
		- This is the project used when no project is given or known.
		  If this is not given, projects must be specified on the
		  command line.
	- GTWS_DEFAULT_VERSION
		- Default version to check out.  Defaults to "trunk"

	These settings should be at the project level of each project:

	- GTWS_PROJECT
		- Name (and base directory) of the project in question
	- gtws_project_clone
		- This is a function used to clone a specific version if a
		  project.  If it is not defined, then it is assumed that the
		  origin for the project contains a single directory per
		  version, and that contains a set of git repo to clone.
	- gtws_project_setup
		- This optional function is called after all cloning is done.

	These settings should be set at the project version level:
	- GTWS_PROJECT_VERSION
		- This is the version of the project.  It's used to pull from
		  the origin correctly.

	
	These things can go anywhere in the tree, and can be overridden
	multiple times if that makes sense:

	GTWS_PATH_EXTRA
		- Extra path elements to be added to the path inside the workspace
	GTWS_FILES_EXTRA
		- Extra files not under version control that should be copied
		  into each checkout in the workspace.  This is things like
		  .git/info/exclude and each file is relative to the base of
		  it's repo.


- Origin dirs
	GTWS_ORIGIN (in most scripts) points to the pristine git checkouts to
	pull from and push to.

	- Layout of ${GTWS_ORIGIN}
		- /<project>
			- This is the base for repos for a project.
			- If gtws_project_clone is given, this can have any
			  layout desired.
			- If gtws_project_clone is *not* given, this must
			  contain a single subdirectory per version, each
			  containing a set of git repos to clone.

- Workflow
	- Need new workspace for ROUTE-2222 on gtrunk itrunk
		- cd ~/src/trunk
		- mkws r2222
			- gvsersion comes from PWD
			- iversion defaults to
				- itrunk for gtrunk
				- i11.0 for 3.3
				- i10.0 for 3.2
				- i5.0 for 3.1
			- Makes in $PWD:
				- /docs
				- /gatt
				- /itrunk
				- /routing
			- All checkouts have .git/info/exclude copied
			- routing and gatt have tags made
			- All RTOS checkoutes have routing symlinked and ./setup run
		- startws r2222
			- Sets up environment
			- changes prompt
		- cd routing
			- Goes to gated
		- Make changes; commit
		- cd gatt/autobot
			- Goes to gatt/autobot
		- autobot ospf 26,27,28,60
			- Runs ospf tests on racks
		- Push
			- cd routing
			- wspush
				- This does:
				- git push
				- cd ${GTWS_ORIGIN}/${GTWS_GATED_VERSION}/routing
				- git reset --hard
				- git svn dcommit
				- cd -
		- Update origin
			- origin
				- Updates all gated/gatt/docs versions
			- origin -r
				- Updates all rtos as well
			- origin trunk
				- Updates just gated/gatt/docs trunk
		- Update gated checkout from origin
			- cdws routing
			- git pull --rebase
			- Must be done after "git svn dcommit" from origin if
			  workspace is to be used again
		- Done with workspace
			- rmws g2222
			- Removes working dirs as well
